
<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" type="text/css" href="https://static.freshdev.io/fdk/2.0/assets/freshworks_crm.css">
    <script src="{{{appclient}}}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="./assets/iparams.css">
    <script src="./assets/iparams.js"></script>
    <script type="module"
        src="https://cdn.jsdelivr.net/npm/@freshworks/crayons@v4/dist/crayons/crayons.esm.js"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/@freshworks/crayons@v4/dist/crayons/crayons.js"></script>
    <style>
        .dropdown {
            width: 10%;
            color: black;
            border: 5;
        }

        #error_div {
            color: red;
        }

        .select2-container {
            width: 70%;
        }

        .select2-container--default {
            width: 80% !important;
        }

        .select2-locked {
            padding: 0px !important;
        }
    </style>
    <script type="text/javascript">
        jQuery("#error_div").hide();
        jQuery("#department").select2({
            width: "resolve"
        });
    </script>
    <script type="text/javascript">
        function getConfigs(configs) {
            jQuery("#error_div").hide();
            jQuery("input[name=api_key]").val(configs["api_key"]);
        }
    </script>
    <script type="text/javascript">
        function validate() {
            let isValid = true;
            var input = document.getElementById("apiKey").value;
            console.log("in validate", input)
            if (!input) {
                jQuery("#error_div").show();
                isValid = false;
            }
            else {
                jQuery("#error_div").hide();
            }
            return isValid;
        }
    </script>
    <script type="text/javascript">
        function postConfigs() {
            var requester = {};
            var api_key = document.getElementById('apiKey').value;
            // api_key = api_key.value;
            console.log("api_key", api_key);
            var group = document.getElementById('group').value;
            var agent = document.getElementById('agent').value;
            requester["group"] = group;
            requester["agent"] = agent;


            return {
                __meta: {
                    secure: ["api_key"]
                },
                api_key,
                group,
                agent
            }
        }
    </script>


<script type="text/javascript">
    (async function initApp(){
        
        let feilds = []
        app.initialized().then(
            async function (_client) {
                window.client = _client;

             client.request.invokeTemplate("getTickets").then(function (data) {
                console.log("data",data);
                const response = JSON.parse(data.response)
                // console.log("response",response);
                response.forEach(ticket => {
                     feilds.push(ticket.label)

                        });

                        // console.log("array of feild label", feilds);
                    },
                    function (error) {
                        console.log("error", error);
                    }
                )
            },
            function (error) {
                console.error(error);
            }
        );
    })();

    
  var feild= document.getElementById('ticketFeilds')
  console.log("feild",feild);
//   .addEventListener('fwChange', function(e) {
//     console.log("ticket feilds clicked");
//     console.log(e.target.value);
    
//   });
</script>;

</head>

<body>
    <div class="requester-fields" style="padding: 2%;">
        <h3>Requester Fields</h3>
        <fw-input id="apiKey" , label="Api Key" , required="true" , placeholder="Enter the API Key" clear-input>
        </fw-input>


        <fw-select id="ticketFeilds" , label="Ticket Fields" required="true"
            placeholder="Select the Ticket feilds" hint-text="Select singluar option">
            <fw-select-option value="1">subject</fw-select-option>
            <fw-select-option value="2">Priority</fw-select-option>
        </fw-select>

        <fw-select id="group" , label="Group" required="true" placeholder="Select the category"
            hint-text="Select singluar option">
            <fw-select-option value="1">Billing</fw-select-option>
            <fw-select-option value="2">Admission</fw-select-option>
        </fw-select>

        <fw-select id="agent" , label="Agent" required="true"  placeholder="Select the Agent"
            hint-text="Select singluar option">
            <fw-select-option value="1">Agent1</fw-select-option>
            <fw-select-option value="2">Agent2</fw-select-option>
        </fw-select>
</body>
</html>